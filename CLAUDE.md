# Jazz Piano Chords - 仕様書

ジャズピアノのコード学習を支援するWebアプリケーション

## 概要

ジャズピアノの実践的なコードボイシング（ルート音省略 + テンション追加）を視覚的に学習できるアプリケーション。運指最適化により演奏しやすいコード進行を自動生成。

## 現在の機能

### 1. コード入力
- **テキストエリア**: 複数行対応の入力フィールド
- **サポート形式**: カンマ区切り、改行区切り、または両方の組み合わせ
- **対応コードタイプ**: M7, m7, 7, m7b5, dim7, alt, メジャートライアド, マイナートライアド

### 2. コード解釈・自動変換
- **自動解釈**: 単純な音名（Eb等）は自動的にM7として解釈
- **フラット表記**: 黒鍵は全て♭記号で統一表示（Db, Eb, Gb, Ab, Bb）
- **オルタード自動変換**: ツーファイブワン進行（m7→7→m）でドミナント7thを自動的にaltコードに変換
- **動的生成**: 音程理論に基づいた構成音の自動算出

### 3. 運指最適化ボイシング
- **ルート音省略**: ジャズピアノの実践的な演奏法に準拠
- **テンション追加**: 9thテンション（2度上のオクターブ）を自動追加
- **音域制限**: C#2-D#3の範囲内で適切なオクターブに配置（C2-E3表示）
- **転回形最適化**: 動的プログラミングによる指位置最適化
- **手の幅考慮**: 1オクターブを理想とした音域ペナルティシステム
- **指位置保持**: 同じ指で同じ音を維持する転回形を優先選択

### 4. 視覚的表示機能
- **複数鍵盤表示**: 改行ごとに行分けして横並び表示（最大8コード対応）
- **構成音ハイライト**: 青色でコード構成音を強調
- **運指変化表示**: 前コードから変化した音を赤色でハイライト
- **行ラベル**: Line 1, Line 2... で各行を識別
- **コンパクト設計**: ピアノ周辺の余白を最小化
- **レスポンシブ対応**: スマートフォン・タブレットに最適化されたレイアウト

### 5. スマートフォン向け簡易入力
- **音名ボタン**: C, D, E, F, G, A, B の直接入力
- **記号ボタン**: ♭, ♯ の簡単入力
- **コードタイプボタン**: M7, m7, 7, m7♭5, dim7, alt のワンタッチ入力
- **操作ボタン**: 空白, カンマ, 改行の便利機能
- **プリセット機能**: Autumn Leaves進行のワンボタン入力
- **カーソル位置挿入**: 現在のカーソル位置に文字を挿入

## 技術仕様

### フロントエンド
- **HTML5**: セマンティックなマークアップ、動的DOM生成
- **CSS3**: レスポンシブデザイン、Flexboxレイアウト、カスタムキーボードスタイル
- **JavaScript (ES6+)**: モジュール設計、音楽理論計算、最適化アルゴリズム

### 音楽理論実装
- **12平均律**: 正確な半音間隔計算
- **MIDI準拠**: 絶対音高による音程計算
- **コード理論**: インターバル構造による動的コード生成
- **ジャズ理論**: ツーファイブワン進行認識とオルタードコード変換

### 最適化アルゴリズム
- **動的プログラミング**: 最適転回形シーケンス選択
- **指位置スコアリング**: 同一指位置での音保持を最優先
- **演奏性評価**: 手の幅と音域ペナルティによる評価関数
- **転回形生成**: 全可能転回形の自動生成と範囲フィルタリング

### レスポンシブ対応
- **マルチデバイス**: デスクトップ、タブレット、スマートフォン対応
- **メディアクエリ**: 768px（タブレット）、480px（スマートフォン）対応
- **タッチUI**: スマートフォン向け簡易入力ボタン
- **スケール調整**: デバイスサイズに応じたピアノ鍵盤の最適化

## ファイル構造

```
jazz-piano-chords/
├── index.html          # メインページ
├── style.css           # スタイルシート
├── script.js           # アプリケーションロジック
├── CLAUDE.md          # 本仕様書
└── README.md          # プロジェクト概要
```

## 使用例

### 入力例（手動入力）
```
Cm7, F7, BbM7, EbM7
Am7, D7, Gm7
FM7, Bb7, EbM7
```

### 入力例（Autumn Leavesプリセット）
```
Cm7, F7, BbM7, EbM7
Adim7, D7, Gm7, Gm7
Adim7, D7, Gm7, Gm7
Cm7, F7, BbM7, EbM7
Adim7, D7, Gm7, GbM7, Fm7, E7
Adim7, D7, Gm7, Gm7
```

### 出力（運指最適化済み）
- Line 1: Cm7(Eb-G-Bb-D), F7(A-C-Eb-G), BbM7(D-F-A-C), EbM7(G-Bb-D-F)
- Line 2: Am7(C-Eb-G-B), Dalt(Gb-A-C-Eb), Gm7(Bb-D-F-A)
- Line 3: FM7(A-C-E-G), Bb7(D-F-Ab-C), EbM7(G-Bb-D-F)

### 特徴
- **赤いハイライト**: 前のコードから変化した指位置を表示
- **自動オルタード**: ツーファイブワン進行でD7が自動的にDaltに変換
- **運指最適化**: 各行内で指の移動を最小限に抑制
- **♭表記統一**: 黒鍵は全て♭記号で表示
- **簡易入力**: スマートフォン向けボタンUI
- **プリセット機能**: ジャズスタンダードのワンボタン入力

## 開発環境

- **Live Server**: リアルタイムプレビュー
- **Git**: バージョン管理
- **モダンブラウザ**: Chrome, Firefox, Safari対応
